@tailwind base;
@tailwind components;
@tailwind utilities;

/* ——— Klyr Design System: Workplace OS ——— */
/* Minimalist, calm, high-tech, secure, premium */

:root {
  --color-primary: #3B82F6;
  --color-accent: #2563eb;
  --color-bg: #FFFFFF;
  --color-text: #111827;
  --border-radius: 0.5rem;
  --font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  /* Motion */
  --motion-duration: 200ms;
  --motion-ease: cubic-bezier(0.4, 0, 0.2, 1);
  /* Depth: soft shadows instead of harsh borders */
  --shadow-tile: 0 1px 3px rgba(0, 0, 0, 0.06);
  --shadow-tile-hover: 0 4px 12px rgba(0, 0, 0, 0.08);
  --shadow-tile-active: 0 4px 14px rgba(59, 130, 246, 0.12);
  --shadow-dock: 0 -2px 12px rgba(0, 0, 0, 0.06);
  --border-subtle: 1px solid rgba(0, 0, 0, 0.06);
  --border-subtle-dark: 1px solid rgba(255, 255, 255, 0.08);
}

:root {
  --background: #f8fafc;
  --foreground: #0f172a;
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0f172a;
    --foreground: #f1f5f9;
    --shadow-tile: 0 1px 3px rgba(0, 0, 0, 0.2);
    --shadow-tile-hover: 0 4px 12px rgba(0, 0, 0, 0.3);
    --shadow-tile-active: 0 4px 14px rgba(59, 130, 246, 0.2);
    --shadow-dock: 0 -2px 12px rgba(0, 0, 0, 0.25);
  }
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: var(--font-family);
  -webkit-font-smoothing: antialiased;
}

/* Apply theme variables to components */
.themed-primary {
  background-color: var(--color-primary);
}

.themed-primary-text {
  color: var(--color-primary);
}

.themed-accent {
  background-color: var(--color-accent);
}

.themed-border {
  border-radius: var(--border-radius);
}

/* Override Tailwind primary colors with theme variables */
.bg-primary-600 {
  background-color: var(--color-primary) !important;
}

.bg-primary-700 {
  background-color: var(--color-accent) !important;
}

.text-primary-600 {
  color: var(--color-primary) !important;
}

.text-primary-700 {
  color: var(--color-accent) !important;
}

.border-primary-600 {
  border-color: var(--color-primary) !important;
}

.hover\:bg-primary-700:hover {
  background-color: var(--color-accent) !important;
}

.hover\:text-primary-700:hover {
  color: var(--color-accent) !important;
}

/* Apply border radius from theme */
button, input, select, textarea, .rounded-lg {
  border-radius: var(--border-radius);
}

* {
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

html, body {
  max-width: 100vw;
  overflow-x: hidden;
}

/* React Grid Layout Styles */
.react-grid-layout {
  position: relative;
  transition: height var(--motion-duration) var(--motion-ease);
}

.react-grid-item {
  transition: left var(--motion-duration) var(--motion-ease),
    top var(--motion-duration) var(--motion-ease),
    width var(--motion-duration) var(--motion-ease),
    height var(--motion-duration) var(--motion-ease);
}

.react-grid-item img {
  pointer-events: none;
  user-select: none;
}

.react-grid-item > .react-resizable-handle {
  position: absolute;
  width: 20px;
  height: 20px;
}

.react-grid-item > .react-resizable-handle::after {
  content: "";
  position: absolute;
  right: 3px;
  bottom: 3px;
  width: 5px;
  height: 5px;
  border-right: 2px solid rgba(0, 0, 0, 0.4);
  border-bottom: 2px solid rgba(0, 0, 0, 0.4);
}

@media (prefers-color-scheme: dark) {
  .react-grid-item > .react-resizable-handle::after {
    border-right-color: rgba(255, 255, 255, 0.4);
    border-bottom-color: rgba(255, 255, 255, 0.4);
  }
}

.react-resizable-hide > .react-resizable-handle {
  display: none;
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-sw {
  bottom: 0;
  left: 0;
  cursor: sw-resize;
  transform: rotate(90deg);
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-se {
  bottom: 0;
  right: 0;
  cursor: se-resize;
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-nw {
  top: 0;
  left: 0;
  cursor: nw-resize;
  transform: rotate(180deg);
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-ne {
  top: 0;
  right: 0;
  cursor: ne-resize;
  transform: rotate(270deg);
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-w,
.react-grid-item > .react-resizable-handle.react-resizable-handle-e {
  top: 50%;
  margin-top: -10px;
  cursor: ew-resize;
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-w {
  left: 0;
  transform: rotate(135deg);
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-e {
  right: 0;
  transform: rotate(315deg);
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-n,
.react-grid-item > .react-resizable-handle.react-resizable-handle-s {
  left: 50%;
  margin-left: -10px;
  cursor: ns-resize;
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-n {
  top: 0;
  transform: rotate(225deg);
}

.react-grid-item > .react-resizable-handle.react-resizable-handle-s {
  bottom: 0;
  transform: rotate(45deg);
}

.react-grid-item.react-grid-placeholder {
  background: rgb(59, 130, 246);
  opacity: 0.2;
  transition-duration: 100ms;
  z-index: 2;
  border-radius: 0.5rem;
}

/* ——— Tile System: depth, motion, primary ——— */
.tile-container {
  height: 100%;
  width: 100%;
  animation: tile-enter var(--motion-duration) var(--motion-ease) forwards;
}

/* Opacity only — do not use transform here or it overrides react-grid-layout’s position transform */
@keyframes tile-enter {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.tile-container .tile-surface {
  border-radius: 0.5rem;
  border: var(--border-subtle);
  box-shadow: var(--shadow-tile);
  background: var(--color-bg);
  transition: box-shadow var(--motion-duration) var(--motion-ease),
    transform var(--motion-duration) var(--motion-ease),
    border-color var(--motion-duration) var(--motion-ease);
}

@media (prefers-color-scheme: dark) {
  .tile-container .tile-surface {
    border: var(--border-subtle-dark);
    background: rgb(30 41 59);
  }
}

.tile-container:hover .tile-surface {
  box-shadow: var(--shadow-tile-hover);
  transform: translateY(-1px);
}

.tile-container:hover .tile-primary-btn {
  opacity: 1;
  pointer-events: auto;
}

.tile-primary-btn {
  pointer-events: none;
}

.tile-container.tile-primary .tile-surface {
  box-shadow: var(--shadow-tile-hover), 0 0 0 1px rgba(59, 130, 246, 0.15);
}

.tile-container.tile-primary .tile-surface::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--color-primary);
  border-radius: 0.5rem 0.5rem 0 0;
  pointer-events: none;
}

/* Active tile (focused) — subtle shadow + thin top accent */
.tile-container.tile-active .tile-surface {
  box-shadow: var(--shadow-tile-active);
}
.tile-container.tile-active .tile-surface::after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: var(--color-primary);
  opacity: 0.6;
  border-radius: 0.5rem 0.5rem 0 0;
  pointer-events: none;
}

.tile-container .tile-surface {
  position: relative;
}

/* Encrypted indicator — minimal */
.tile-encrypted {
  font-size: 10px;
  color: var(--foreground);
  opacity: 0.5;
  display: inline-flex;
  align-items: center;
  gap: 2px;
}

/* Fade-in for toasts */
@keyframes fade-in {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-in {
  animation: fade-in var(--motion-duration) var(--motion-ease);
}

/* Flux shimmer */
@keyframes flux-shimmer {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

.flux-shimmer {
  animation: flux-shimmer 2s var(--motion-ease) infinite;
}

/* Dock */
.klyr-dock {
  box-shadow: var(--shadow-dock);
  transition: opacity var(--motion-duration) var(--motion-ease),
    transform var(--motion-duration) var(--motion-ease);
}

/* Call overlay — dark theme for video UI */
[data-call-overlay] {
  --call-bg: #0f172a;
  --call-surface: #1e293b;
  --call-border: #334155;
  --call-text: #f8fafc;
  --call-muted: #94a3b8;
  --call-accent: #3b82f6;
  --call-error: #ef4444;
}
